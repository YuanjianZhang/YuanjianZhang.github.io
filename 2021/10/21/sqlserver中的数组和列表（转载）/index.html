<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>sql server 中的数组和列表（转载） - 不知选啥就选C</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="一个记录生活的Blog">





    <meta property="og:type" content="article">
<meta property="og:title" content="sql server 中的数组和列表（转载）">
<meta property="og:url" content="http://yoursite.com/2021/10/21/sqlserver%E4%B8%AD%E7%9A%84%E6%95%B0%E7%BB%84%E5%92%8C%E5%88%97%E8%A1%A8%EF%BC%88%E8%BD%AC%E8%BD%BD%EF%BC%89/index.html">
<meta property="og:site_name" content="不知选啥就选C">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/images/default.jpeg">
<meta property="article:published_time" content="2021-10-21T01:39:08.000Z">
<meta property="article:modified_time" content="2021-12-13T05:22:19.091Z">
<meta property="article:author" content="zhang">
<meta property="article:tag" content="sql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/images/default.jpeg">





<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    

    



<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    Choose C
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">归档</a>
            
            <a class="navbar-item "
               href="/categories">分类</a>
            
            <a class="navbar-item "
               href="/tags">标签</a>
            
            <a class="navbar-item "
               href="/categories/Technology">技术</a>
            
            <a class="navbar-item "
               href="/other">树洞</a>
            
            <a class="navbar-item "
               href="/about">关于</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜索" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/yuanjianzhang">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            sql server 中的数组和列表（转载）
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2021-10-21T01:39:08.000Z" itemprop="datePublished">10月 21 2021</time>
        </span>
        
        
        <span class="column is-narrow">
            
            
            7 分钟 读完 (约 984 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><img title="default" src="/images/default.jpeg" alt="default">
<span id="more"></span>

<blockquote>
<p>转载自：<a target="_blank" rel="noopener" href="https://www.sommarskog.se/arrays-in-sql.html">Arrays and Lists in SQL Server-The Short Version</a></p>
</blockquote>
<h3 id="原文摘录"><a href="#原文摘录" class="headerlink" title="原文摘录"></a>原文摘录</h3><p><strong>Two Simple Multi-Statement Functions</strong><br>If you search the web, there is no end of functions to split strings into table format. Here, I will present two simple functions that run on SQL 2008 or later, one for a list of integers and one for a list of strings. I should immediately warn you that these functions are not the most efficient and therefore not suitable if you have long lists with thousands of elements. But they are perfectly adequate if you are passing the contents of a multi-choice checkbox from a client where you would rarely have as many as 50 elements.</p>
<p>I opted to share these functions because they are simple and you can easily adapt them if you want different behaviour with regards to the choices that I have made. In my long article, I describe methods that are faster, but they all require extra setup than just a function.</p>
<p>Below is a function to split a delimited list of integers. The function accepts a parameter for the delimiter which can be up to 10 characters long. The function returns the list positions for the elements. An empty element is returned as NULL. If there is a non-numeric value in the list, there will be a conversion error.</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> intlist_to_tbl (<span class="hljs-variable">@list</span>  nvarchar(MAX),</span><br><span class="line">                                <span class="hljs-variable">@delim</span> nvarchar(<span class="hljs-number">10</span>))</span><br><span class="line">   <span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@tbl</span> <span class="hljs-keyword">TABLE</span> (listpos <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),</span><br><span class="line">                       n       <span class="hljs-type">int</span> <span class="hljs-keyword">NULL</span>) <span class="hljs-keyword">AS</span></span><br><span class="line"><span class="hljs-keyword">BEGIN</span></span><br><span class="line">   <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@pos</span>       <span class="hljs-type">int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>,</span><br><span class="line">           <span class="hljs-variable">@nextpos</span>   <span class="hljs-type">int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>,</span><br><span class="line">           <span class="hljs-variable">@valuelen</span>  <span class="hljs-type">int</span>,</span><br><span class="line">           <span class="hljs-variable">@delimlen</span>  <span class="hljs-type">int</span> <span class="hljs-operator">=</span> datalength(<span class="hljs-variable">@delim</span>) <span class="hljs-operator">/</span> <span class="hljs-number">2</span></span><br><span class="line"></span><br><span class="line">   WHILE <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span></span><br><span class="line">   <span class="hljs-keyword">BEGIN</span></span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">=</span> charindex(<span class="hljs-variable">@delim</span> <span class="hljs-keyword">COLLATE</span> Czech_BIN2, <span class="hljs-variable">@list</span>, <span class="hljs-variable">@pos</span>)</span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@valuelen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-variable">@nextpos</span></span><br><span class="line">                              <span class="hljs-keyword">ELSE</span> len(<span class="hljs-variable">@list</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span></span><br><span class="line">                         <span class="hljs-keyword">END</span> <span class="hljs-operator">-</span> <span class="hljs-variable">@pos</span></span><br><span class="line">      <span class="hljs-keyword">INSERT</span> <span class="hljs-variable">@tbl</span> (n)</span><br><span class="line">         <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>, <span class="hljs-built_in">nullif</span>(<span class="hljs-built_in">substring</span>(<span class="hljs-variable">@list</span>, <span class="hljs-variable">@pos</span>, <span class="hljs-variable">@valuelen</span>), <span class="hljs-string">''</span>)))</span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@pos</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@delimlen</span></span><br><span class="line">   <span class="hljs-keyword">END</span></span><br><span class="line">   <span class="hljs-keyword">RETURN</span></span><br><span class="line"><span class="hljs-keyword">END</span></span><br></pre></td></tr></tbody></table></figure>

<p>You are likely to be puzzled by the COLLATE clause. This is a small speed booster. By forcing a binary collation, we avoid that SQL Server employs the full Unicode rules when searching for the delimiter. This pays off when scanning long strings. Why Czech? The language does not matter here, so I just picked one with a short name.</p>
<p>And why datalength divided by 2 and not len? datalength returns the length in bytes, whence the division. len does not count trailing spaces, so it does not work if the delimiter is a space.</p>
<p>Here are two examples:</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> intlist_to_tbl(<span class="hljs-string">'1,2,3, 677,7 , ,-1'</span>, <span class="hljs-string">','</span>)</span><br><span class="line"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> intlist_to_tbl(<span class="hljs-string">'1&lt;-&gt;2&lt;-&gt;3&lt;-&gt; 677&lt;-&gt;7&lt;-&gt;&lt;-&gt;-1'</span>, <span class="hljs-string">'&lt;-&gt;'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>Since the values are the same in both lists, the output is the same:</p>
<table>
<thead>
<tr>
<th align="center">listpos</th>
<th align="center">n</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">677</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">NULL</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">-1</td>
</tr>
</tbody></table>
<p>Here is an example of how you would use it in a simple query:</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> ...</span><br><span class="line"><span class="hljs-keyword">FROM</span>   tbl </span><br><span class="line"><span class="hljs-keyword">WHERE</span>  col <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> n <span class="hljs-keyword">FROM</span> intlist_to_tbl(<span class="hljs-string">'1,2,3,4'</span>, <span class="hljs-string">','</span>))</span><br></pre></td></tr></tbody></table></figure>

<p>If you find that you are only using comma-separated lists, you may grow tired of having to specify the delimiter every time. To that end, this wrapper can be handy:</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> intlisttotbl (<span class="hljs-variable">@list</span> nvarchar(MAX)) <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">AS</span></span><br><span class="line"><span class="hljs-keyword">RETURN</span> (</span><br><span class="line">   <span class="hljs-keyword">SELECT</span> listpos, n <span class="hljs-keyword">FROM</span> intlist_to_tbl(<span class="hljs-variable">@list</span>, <span class="hljs-string">','</span>)</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p>I leave it as an exercise to the reader to come up with a better name.</p>
<p>Here is a function for a list of strings. It accepts an input parameter of the type nvarchar(MAX), but the return table has both a varchar and an nvarchar column. I will return to why in a second. Like intlist_to_tbl it returns the list position. It trims leading and trailing spaces. In difference to intlist_to_tbl, empty elements are returned as empty strings and not as NULL.</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> strlist_to_tbl (<span class="hljs-variable">@list</span>  nvarchar(MAX),</span><br><span class="line">                                <span class="hljs-variable">@delim</span> nvarchar(<span class="hljs-number">10</span>))</span><br><span class="line">   <span class="hljs-keyword">RETURNS</span> <span class="hljs-variable">@tbl</span> <span class="hljs-keyword">TABLE</span> (listpos <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">IDENTITY</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),</span><br><span class="line">                       str     <span class="hljs-type">varchar</span>(<span class="hljs-number">4000</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,</span><br><span class="line">                       nstr    nvarchar(<span class="hljs-number">4000</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>) <span class="hljs-keyword">AS</span></span><br><span class="line"><span class="hljs-keyword">BEGIN</span></span><br><span class="line">   <span class="hljs-keyword">DECLARE</span> <span class="hljs-variable">@pos</span>       <span class="hljs-type">int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>,</span><br><span class="line">           <span class="hljs-variable">@nextpos</span>   <span class="hljs-type">int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>,</span><br><span class="line">           <span class="hljs-variable">@valuelen</span>  <span class="hljs-type">int</span>,</span><br><span class="line">           <span class="hljs-variable">@nstr</span>      nvarchar(<span class="hljs-number">4000</span>),</span><br><span class="line">           <span class="hljs-variable">@delimlen</span>  <span class="hljs-type">int</span> <span class="hljs-operator">=</span> datalength(<span class="hljs-variable">@delim</span>) <span class="hljs-operator">/</span> <span class="hljs-number">2</span></span><br><span class="line"></span><br><span class="line">   WHILE <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span></span><br><span class="line">   <span class="hljs-keyword">BEGIN</span></span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">=</span> charindex(<span class="hljs-variable">@delim</span> <span class="hljs-keyword">COLLATE</span> Czech_BIN2, <span class="hljs-variable">@list</span>, <span class="hljs-variable">@pos</span>)</span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@valuelen</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-variable">@nextpos</span></span><br><span class="line">                              <span class="hljs-keyword">ELSE</span> len(<span class="hljs-variable">@list</span>) <span class="hljs-operator">+</span> <span class="hljs-number">1</span></span><br><span class="line">                         <span class="hljs-keyword">END</span> <span class="hljs-operator">-</span> <span class="hljs-variable">@pos</span></span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@nstr</span> <span class="hljs-operator">=</span> ltrim(rtrim(<span class="hljs-built_in">substring</span>(<span class="hljs-variable">@list</span>, <span class="hljs-variable">@pos</span>, <span class="hljs-variable">@valuelen</span>)))</span><br><span class="line">      <span class="hljs-keyword">INSERT</span> <span class="hljs-variable">@tbl</span> (str, nstr)</span><br><span class="line">         <span class="hljs-keyword">VALUES</span> (<span class="hljs-variable">@nstr</span>, <span class="hljs-variable">@nstr</span>)</span><br><span class="line">      <span class="hljs-keyword">SELECT</span> <span class="hljs-variable">@pos</span> <span class="hljs-operator">=</span> <span class="hljs-variable">@nextpos</span> <span class="hljs-operator">+</span> <span class="hljs-variable">@delimlen</span></span><br><span class="line">   <span class="hljs-keyword">END</span></span><br><span class="line">   <span class="hljs-keyword">RETURN</span></span><br><span class="line"><span class="hljs-keyword">END</span></span><br></pre></td></tr></tbody></table></figure>

<p>Here are two examples:</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> strlist_to_tbl(N<span class="hljs-string">'Alpha (α) | Beta (β)|Gamma (γ)|Delta (δ)|'</span>, <span class="hljs-string">'|'</span>)</span><br><span class="line"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> strlist_to_tbl(N<span class="hljs-string">'a///b///c///v///x'</span>, <span class="hljs-string">'///'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>Here is the output:</p>
<p>listpos   |  str   |     nstr<br>|:–:|:–:|:–:|<br>1    |      Alpha (a)| Alpha (α)<br>2    |      Beta (ß) | Beta (β)<br>3    |      Gamma (?)| Gamma (γ)<br>4    |      Delta (d)| Delta (δ)<br>5     |              |   |</p>
<p>listpos   |  str   |     nstr<br>|:–:|:–:|:–:|<br>1      |    a     |    a<br>2      |    b     |    b<br>3      |    c     |    c<br>4      |    v     |    v<br>5      |    x     |    x</p>
<p>Note in the first result set that the Greek characters has been replaced by fallback characters in the str column. They are unchanged in the nstr column. (If you have a Greek or a UTF-8 collation, the two columns will be identical, though.)</p>
<p>Here are two examples of using this function:</p>
<figure class="highlight sql hljs"><figcaption><span>sql</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> ...</span><br><span class="line"><span class="hljs-keyword">FROM</span>   tbl </span><br><span class="line"><span class="hljs-keyword">WHERE</span>  varcharcol <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> str <span class="hljs-keyword">FROM</span> strlist_to_tbl(<span class="hljs-string">'a,b,c'</span>, <span class="hljs-string">','</span>))</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">SELECT</span> ...</span><br><span class="line"><span class="hljs-keyword">FROM</span>   tbl </span><br><span class="line"><span class="hljs-keyword">WHERE</span>  nvarcharcol <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> nstr <span class="hljs-keyword">FROM</span> strlist_to_tbl(<span class="hljs-string">'a,b,c'</span>, <span class="hljs-string">','</span>))</span><br></pre></td></tr></tbody></table></figure>

<p>These examples illustrate why there are two columns. If you are going to use the list against a varchar column, you need to use the str column. This is important because of the type-conversion rules in SQL Server. If you mistakenly compare varcharcol to nstr, varcharcol will be converted to nvarchar, and this can render any index on varcharcol ineligible for the query, leading to a performance disaster as the table must be scanned. And conversely, if you have an nvarchar column, you need to compare it to the nvarchar value, since else the result can be incorrect because of the character replacement with the conversion to varchar.</p>
<p>I like to point out that these functions are by no means cast in stone, but see them as suggestions. Feel free to modify them according to your preferences and needs.</p>
</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/sql/">#sql</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2021/10/21/Markdown%E8%AF%AD%E6%B3%95%E9%80%9F%E6%9F%A5%E8%A1%A8/">Markdown语法速查表</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2021/09/01/MongoDb%E5%88%9D%E8%AF%86/">MongoDb初识</a>
            
        </span>
    </div>
    
</article>





    </div>
</section>

<!-- <script>
    (function () {
        if ('{{ page.password }}') {
            if (prompt('请输入文章密码') !== '{{ page.password }}') {
                alert('密码错误！');
                if (history.length === 1) {
                    location.replace("https://minos.design"); // 这里替换成你的首页
                } else {
                    history.back();
                }
            }
        }
    })();
</script> -->
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2022 zhang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站内搜索" />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>